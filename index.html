<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>åˆ›æ„å‘æ•£åŠ©æ‰‹</title>
    <style>
        body { margin: 0; background: #fdfdfd; font-family: sans-serif; height: 100vh; overflow: hidden; }
        #canvas { width: 100%; height: 100%; position: relative; }
        .bubble { position: absolute; padding: 15px 25px; background: white; border: 1px solid #ddd; border-radius: 40px; cursor: pointer; transform: translate(-50%, -50%); transition: 0.3s; text-align: center; box-shadow: 0 4px 15px rgba(0,0,0,0.05); }
        .bubble:hover { background: #FFD700; border-color: #000; transform: translate(-50%, -50%) scale(1.1); }
        .zh { display: block; font-weight: bold; font-size: 16px; }
        .en { font-size: 10px; color: #888; text-transform: uppercase; }
        .footer { position: fixed; bottom: 30px; width: 100%; text-align: center; display: flex; justify-content: center; gap: 10px; }
        input { padding: 12px 20px; border-radius: 25px; border: 2px solid #000; width: 280px; outline: none; }
        #set-api { cursor: pointer; border: none; background: #000; color: #fff; width: 45px; height: 45px; border-radius: 50%; font-size: 20px; }
        #loader { position: fixed; top: 20px; left: 50%; transform: translateX(-50%); display: none; background: #000; color: #FFD700; padding: 10px 20px; border-radius: 20px; z-index: 100; font-weight: bold; }
    </style>
</head>
<body>
    <div id="loader">Gemini æ­£åœ¨è”æƒ³ä¸­...</div>
    <div id="canvas"></div>
    <div class="footer">
        <input type="text" id="in" placeholder="è¾“å…¥çµæ„Ÿè¯æ±‡å¹¶å›è½¦...">
        <button id="set-api">ğŸ”‘</button>
    </div>

    <script>
        let apiKey = "";
        const canvas = document.getElementById('canvas');
        const input = document.getElementById('in');

        document.getElementById('set-api').onclick = () => {
            const k = prompt("è¯·è¾“å…¥ä½ çš„ Gemini API Key:");
            if(k) { apiKey = k.trim(); alert("Key å·²å°±ç»ªï¼"); }
        };

        input.onkeypress = (e) => {
            if (e.key === 'Enter' && input.value.trim()) {
                addBubble(input.value.trim(), "START", window.innerWidth/2, window.innerHeight/2);
                input.value = "";
            }
        };

        function addBubble(zh, en, x, y) {
            const b = document.createElement('div');
            b.className = 'bubble';
            b.style.left = x + 'px'; b.style.top = y + 'px';
            b.innerHTML = `<span class="zh">${zh}</span><span class="en">${en}</span>`;
            // ç‚¹å‡»æ°”æ³¡è§¦å‘è”æƒ³
            b.onclick = (event) => {
                event.stopPropagation();
                spread(zh, x, y);
            };
            canvas.appendChild(b);
        }

        async function spread(word, x, y) {
            if(!apiKey) return alert("è¯·å…ˆç‚¹å‡»ğŸ”‘è®¾ç½® API Keyï¼");
            document.getElementById('loader').style.display = 'block';
            
            // æ„é€ å®Œæ•´çš„ API åœ°å€
            const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${apiKey}`;

            try {
                const response = await fetch(url, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: `ä½ æ˜¯ä¸€ä¸ªåˆ›æ„åŠ©æ‰‹ã€‚è¯·æ ¹æ®è¯è¯­ "${word}" ç»™å‡º8ä¸ªç›¸å…³çš„å‘æ•£è¯ã€‚è¦æ±‚ï¼šæ ¼å¼ä¸º"ä¸­æ–‡(è‹±æ–‡)"ï¼Œç”¨é€—å·éš”å¼€ï¼Œä¸è¦æœ‰ä»»ä½•å¤šä½™çš„è§£é‡Šã€‚` }] }]
                    })
                });

                const data = await response.json();
                
                if (data.candidates && data.candidates[0]) {
                    const aiText = data.candidates[0].content.parts[0].text;
                    // è§£æ AI è¿”å›çš„æ–‡æœ¬
                    const keywords = aiText.split(/[,ï¼Œ]/).map(s => s.trim());
                    keywords.forEach((item, i) => {
                        const angle = (i / keywords.length) * Math.PI * 2;
                        const dist = 180; // å‘æ•£è·ç¦»
